(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30edbc11"],{"6b57":function(t,e,s){"use strict";s("a410")},a410:function(t,e,s){},aeae:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"data-view"},[e("div",{staticClass:"data-header"},[e("h2",[t._v("ğŸ“Š æ•°æ®å±•ç¤º")]),t.hasData?e("span",{staticClass:"row-count"},[e("i",{staticClass:"el-icon-s-data",staticStyle:{"margin-right":"6px"}}),t._v(" å…±"),e("span",{staticClass:"highlight-number"},[t._v(t._s(t.filteredDataLength))]),t._v(" è¡Œæ•°æ® ")]):t._e(),e("el-button",{staticClass:"back-btn",attrs:{type:"text"},on:{click:t.goToUpload}},[e("i",{staticClass:"el-icon-arrow-left",staticStyle:{"margin-right":"6px"}}),t._v(" è¿”å›ä¸Šä¼  ")])],1),e("div",{staticClass:"data-container"},[t.hasData?e("DataTable",{attrs:{data:t.csvData},on:{"filter-change":t.handleFilterChange}}):t._e()],1)])},a=[],l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"data-table"},[e("div",{staticClass:"table-controls"},[e("div",{staticClass:"controls-left"},[e("div",{staticClass:"date-range-container"},[e("el-date-picker",{staticClass:"custom-date-picker",attrs:{type:"daterange","range-separator":"è‡³","start-placeholder":"å¼€å§‹æ—¥æœŸ","end-placeholder":"ç»“æŸæ—¥æœŸ",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",disabled:t.isDateRangeInvalid},on:{change:t.handleDateChange},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("el-input",{staticClass:"category-search-input input-with-select",attrs:{placeholder:"è¯·è¾“å…¥æœç´¢å†…å®¹",size:"medium"},model:{value:t.searchKeyword,callback:function(e){t.searchKeyword=e},expression:"searchKeyword"}},[e("el-select",{staticClass:"search-type-select",attrs:{slot:"prepend",size:"medium"},slot:"prepend",model:{value:t.searchType,callback:function(e){t.searchType=e},expression:"searchType"}},[e("el-option",{attrs:{label:"å›½å®¶",value:"å›½å®¶"}}),e("el-option",{attrs:{label:"è½åœ°åª’ä½“",value:"è½åœ°åª’ä½“"}})],1)],1),e("div",{staticClass:"tag-search-container"},[e("el-input",{staticClass:"tag-input",class:{"expression-error":t.expressionError},attrs:{placeholder:"è¯·è¾“å…¥æ ‡ç­¾ï¼Œé€»è¾‘è¿ç®—ç¬¦ä¸¤ä¾§ç”¨ç©ºæ ¼éš”å¼€"},model:{value:t.tagExpression,callback:function(e){t.tagExpression=e},expression:"tagExpression"}}),e("el-tooltip",{attrs:{placement:"top"}},[e("div",{staticStyle:{"white-space":"pre-line","text-align":"left","line-height":"1.5"},attrs:{slot:"content"},slot:"content"},[t._v(" æ”¯æŒçš„è¿ç®—ç¬¦ï¼šAND(å’Œ)ã€OR(æˆ–)ã€NOT(é/ä¸åŒ…æ‹¬)"),e("br"),t._v(" å¯ä½¿ç”¨æ‹¬å·æ”¹å˜ä¼˜å…ˆçº§ï¼Œè¿ç®—ç¬¦ä¸æ‹¬å·ä¸­æ–‡å’Œè‹±æ–‡å¤§å°å†™å‡å¯"),e("br"),t._v(" è¯·æ³¨æ„è¿ç®—ç¬¦ä¸¤ä¾§éœ€ç”¨ç©ºæ ¼éš”å¼€"),e("br"),t._v(" ä¾‹1ï¼š(æ ‡ç­¾1 AND æ ‡ç­¾2) OR NOT æ ‡ç­¾3"),e("br"),t._v(" ä¾‹2ï¼šï¼ˆæ ‡ç­¾1 å’Œ æ ‡ç­¾2ï¼‰ æˆ– ä¸åŒ…æ‹¬ æ ‡ç­¾3"),e("br"),t._v(" æœªåŠ æ‹¬å·çš„æƒ…å†µä¸‹ä¸‰ç§è¿ç®—ç¬¦å¤„äºåŒä¸€ä¼˜å…ˆçº§ï¼Œä»å·¦åˆ°å³è¿ç®—"),e("br"),t._v(" åœ¨æè¿°å¤æ‚é€»è¾‘æ—¶å»ºè®®ä½¿ç”¨æ‹¬å·ï¼Œä¾‹å¦‚ï¼š(æ ‡ç­¾1 AND æ ‡ç­¾2) OR (æ ‡ç­¾3 AND æ ‡ç­¾4) ")]),e("el-button",{staticClass:"expression-help-btn",attrs:{icon:"el-icon-question",size:"small",type:"text"}})],1),t.expressionError?e("div",{staticClass:"expression-error-message"},[t._v(" "+t._s(t.expressionError)+" ")]):t._e()],1)],1),e("div",{staticClass:"controls-right"},[e("div",{staticClass:"action-buttons"},[e("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-search"},on:{click:t.searchByDateRange}},[t._v(" æ£€ç´¢ ")]),e("el-button",{attrs:{type:"success",size:"medium",icon:"el-icon-data-analysis"},on:{click:t.showStatistics}},[t._v(" ç»Ÿè®¡ ")]),e("el-button",{attrs:{type:"info",size:"medium",icon:"el-icon-refresh"},on:{click:t.resetTable}},[t._v(" å¤åŸè¡¨æ ¼ ")]),e("el-button",{attrs:{type:"primary",size:"medium",plain:"",icon:"el-icon-full-screen"},on:{click:t.toggleFullscreen}},[t._v(" å±•å¼€å…¨å± ")])],1)])]),e("div",{ref:"tableContainer",staticClass:"table-container",class:{fullscreen:t.isFullscreen}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"dataTable",class:{"no-data":0===t.filteredData.length},staticStyle:{width:"100%"},attrs:{data:t.filteredData,border:"",striped:!1,height:t.tableHeight,"empty-text":"æš‚æ— æ•°æ®","max-height":t.isFullscreen?"calc(100vh - 100px)":t.tableHeight,"row-class-name":t.tableRowClassName,"cell-class-name":t.tableCellClassName},scopedSlots:t._u([{key:"empty",fn:function(){return[e("el-empty",{attrs:{description:"æš‚æ— æ•°æ®"}})]},proxy:!0}])},t._l(t.headers,(function(s){return e("el-table-column",{key:s,attrs:{prop:s,label:s,"min-width":t.getColumnWidth(s)},scopedSlots:t._u([{key:"default",fn:function({row:i,$index:a,column:l}){return[e("div",{staticClass:"cell-container",on:{mouseenter:function(e){return t.handleCellHover(a,l.property,i[l.property])}}},[e("div",{staticClass:"cell-content",class:{"is-long":t.isLongContent(i[l.property]),"fullscreen-expanded":t.isFullscreen&&t.isLongContent(i[l.property])}},[e("span",{staticClass:"cell-text"},[t._v(" "+t._s(t.formatCellValue(i[l.property],i,l.property))+" ")])]),null!=i[l.property]&&""!==i[l.property]?e("div",{staticClass:"cell-actions"},[e("el-tooltip",{attrs:{content:"å¤åˆ¶å†…å®¹",placement:"top",effect:"light",disabled:t.isFullscreen}},[e("el-button",{staticClass:"cell-action-btn",attrs:{type:"text",size:"mini",icon:"el-icon-document-copy"},on:{click:function(e){return e.stopPropagation(),t.copyCellContent(i[l.property])}}})],1),t.isFullscreen?t._e():e("el-tooltip",{attrs:{content:"æŸ¥çœ‹è¯¦æƒ…",placement:"top",effect:"light"}},[e("el-button",{staticClass:"cell-action-btn",attrs:{type:"text",size:"mini",icon:"el-icon-view"},on:{click:function(e){return e.stopPropagation(),t.showCellDetail(i[l.property],s,a+1)}}})],1)],1):t._e()])]}}],null,!0)})})),1)],1),e("el-dialog",{attrs:{title:"æ•°æ®ç»Ÿè®¡",visible:t.statisticsDialogVisible,width:"90%","max-width":"1200px",center:"","close-on-click-modal":!1,"modal-append-to-body":!1,"append-to-body":!0,"custom-class":"statistics-dialog",modal:!0,"lock-scroll":!1},on:{"update:visible":function(e){t.statisticsDialogVisible=e},open:t.handleStatisticsDialogOpen}},[e("div",{staticClass:"statistics-content"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.statisticsData,border:"",size:"small","show-header":!0}},[e("el-table-column",{attrs:{prop:"articleCount",label:"æ€»ç¯‡æ•°",width:"120"}}),e("el-table-column",{attrs:{prop:"countryCount",label:"å›½å®¶æ•°",width:"120"}}),e("el-table-column",{attrs:{prop:"mediaCount",label:"åª’ä½“æ•°",width:"120"}}),e("el-table-column",{attrs:{prop:"totalViews",label:"æ€»è½åœ°æ¬¡æ•°",width:"150"}}),e("el-table-column",{attrs:{prop:"mediaDetails",label:"åª’ä½“è¯¦æƒ…","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function({row:s}){return[e("div",{staticClass:"cell-container"},[e("div",{staticClass:"cell-content"},[e("span",{staticClass:"cell-text"},[t._v(" "+t._s(s.mediaDetails)+" ")])]),s.mediaDetails?e("div",{staticClass:"cell-actions"},[e("el-tooltip",{attrs:{content:"å¤åˆ¶å†…å®¹",placement:"top",effect:"light"}},[e("el-button",{staticClass:"cell-action-btn",attrs:{type:"text",size:"mini",icon:"el-icon-document-copy"},on:{click:function(e){return e.stopPropagation(),t.copyCellContent(s.mediaDetails)}}})],1),t.isFullscreen?t._e():e("el-tooltip",{attrs:{content:"æŸ¥çœ‹è¯¦æƒ…",placement:"top",effect:"light"}},[e("el-button",{staticClass:"cell-action-btn",attrs:{type:"text",size:"mini",icon:"el-icon-view"},on:{click:function(e){return e.stopPropagation(),t.handleStatisticCellHover(s.mediaDetails,"åª’ä½“è¯¦æƒ…")}}})],1),e("el-tooltip",{attrs:{content:"åˆ†åª’ä½“ç»Ÿè®¡",placement:"top",effect:"light"}},[e("el-button",{staticClass:"cell-action-btn",attrs:{type:"text",size:"mini",icon:"el-icon-s-data"},on:{click:function(e){return e.stopPropagation(),t.showMediaStatistics.apply(null,arguments)}}})],1)],1):t._e()])]}}])}),t.hasSignatureArticleTag?e("el-table-column",{attrs:{prop:"signatureInfo",label:"ç½²åä½œè€…+æ–‡ç« å","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function({row:s}){return[e("div",{staticClass:"cell-container"},[e("div",{staticClass:"cell-content"},[e("span",{staticClass:"cell-text"},[t._v(" "+t._s(s.signatureInfo||"æš‚æ— æ•°æ®")+" ")])]),s.signatureInfo?e("div",{staticClass:"cell-actions"},[e("el-tooltip",{attrs:{content:"å¤åˆ¶å†…å®¹",placement:"top",effect:"light"}},[e("el-button",{staticClass:"cell-action-btn",attrs:{type:"text",size:"mini",icon:"el-icon-document-copy"},on:{click:function(e){return e.stopPropagation(),t.copyCellContent(s.signatureInfo)}}})],1),t.isFullscreen?t._e():e("el-tooltip",{attrs:{content:"æŸ¥çœ‹è¯¦æƒ…",placement:"top",effect:"light"}},[e("el-button",{staticClass:"cell-action-btn",attrs:{type:"text",size:"mini",icon:"el-icon-view"},on:{click:function(e){return e.stopPropagation(),t.handleStatisticCellHover(s.signatureInfo,"ç½²åä½œè€…+æ–‡ç« å")}}})],1)],1):t._e()])]}}],null,!1,1648924160)}):t._e()],1)],1)]),e("el-dialog",{class:{"fullscreen-dialog":t.isFullscreen},attrs:{title:"å•å…ƒæ ¼è¯¦æƒ…",visible:t.detailDialogVisible,width:"700px",center:"","close-on-click-modal":!1,"modal-append-to-body":!1,"append-to-body":!0,"custom-class":"cell-detail-dialog",modal:!0,"lock-scroll":!1},on:{"update:visible":function(e){t.detailDialogVisible=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[e("el-button",{on:{click:function(e){t.detailDialogVisible=!1}}},[t._v("å…³é—­")]),e("el-button",{attrs:{type:"primary"},on:{click:t.copyDetailContent}},[t._v("å¤åˆ¶å†…å®¹")])]},proxy:!0}])},[e("div",{staticClass:"cell-detail-content"},[e("div",{staticClass:"info-card"},[e("div",{staticClass:"info-header"},[e("i",{staticClass:"el-icon-info"}),e("span",{staticClass:"info-title"},[t._v("ä¿¡æ¯")])]),e("div",{staticClass:"info-content"},[e("div",{staticClass:"info-row"},[e("span",{staticClass:"info-value"},[t.isFromStatistics?t._e():[e("span",{staticClass:"info-item row-item"},[t._v("ç¬¬"+t._s(t.detailRow)+"è¡Œ")]),e("span",{staticClass:"info-separator"},[t._v("ï¼›")]),e("span",{staticClass:"info-item sequence-item"},[t._v("åºå·"+t._s(t.detailSequenceValue))]),e("span",{staticClass:"info-separator"},[t._v("ï¼›")])],e("span",{staticClass:"info-item column-item"},[t._v("â€œ"+t._s(t.detailColumn)+"â€")])],2)])])]),e("div",{staticClass:"content-card"},[e("div",{staticClass:"content-header"},[e("i",{staticClass:"el-icon-document"}),e("span",{staticClass:"content-title"},[t._v("å†…å®¹")])]),e("div",{staticClass:"content-body"},[e("div",{ref:"detailContent",staticClass:"content-text"},[t._v(" "+t._s(t.detailContent)+" ")])])])])]),e("el-dialog",{attrs:{title:"åˆ†åª’ä½“ç»Ÿè®¡",visible:t.mediaStatisticsDialogVisible,width:"600px",center:"","close-on-click-modal":!1,"modal-append-to-body":!1,"append-to-body":!0,"custom-class":"media-statistics-dialog",modal:!0,"lock-scroll":!1},on:{"update:visible":function(e){t.mediaStatisticsDialogVisible=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[e("el-button",{on:{click:function(e){t.mediaStatisticsDialogVisible=!1}}},[t._v("å…³é—­")]),e("el-button",{attrs:{type:"primary"},on:{click:t.copyMediaStatistics}},[t._v("å¤åˆ¶ç»Ÿè®¡")])]},proxy:!0}])},[e("div",{staticClass:"media-statistics-content"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.mediaStatisticsData,border:"",size:"small","show-header":!0}},[e("el-table-column",{attrs:{prop:"media",label:"åª’ä½“","min-width":"180"}}),e("el-table-column",{attrs:{prop:"views",label:"æ¬¡æ•°",width:"120"}}),e("el-table-column",{attrs:{prop:"articles",label:"ç¯‡æ•°",width:"120"}})],1)],1)]),e("div",{staticClass:"control-buttons"},[e("el-tooltip",{attrs:{content:"æ»šåŠ¨åˆ°é¡¶éƒ¨",placement:"left",effect:"dark","open-delay":300}},[e("el-button",{staticClass:"control-button scroll-button",attrs:{circle:"",size:"medium"},on:{click:t.scrollToTop}},[e("i",{staticClass:"el-icon-top"})])],1),e("el-tooltip",{attrs:{content:"æ»šåŠ¨åˆ°åº•éƒ¨",placement:"left",effect:"dark","open-delay":300}},[e("el-button",{staticClass:"control-button scroll-button",attrs:{circle:"",size:"medium"},on:{click:t.scrollToBottom}},[e("i",{staticClass:"el-icon-bottom"})])],1),t.isFullscreen?e("el-tooltip",{attrs:{content:"é€€å‡ºå…¨å±",placement:"left",effect:"dark","open-delay":300}},[e("el-button",{staticClass:"control-button exit-fullscreen-button",attrs:{circle:"",size:"medium"},on:{click:t.toggleFullscreen}},[e("i",{staticClass:"el-icon-close"})])],1):t._e()],1)],1)},n=[],o={name:"DataTable",props:{data:{type:Array,default:function(){return[]}}},data(){return{headers:["åºå·","ç¨¿ä»¶æ ‡é¢˜","æ ‡ç­¾","å•æ¡æ€»ç»“/ä¸»é¢˜æ€»ç»“æ”¾æœ€æ–°ä¸€æ¡","æ—¥æœŸ","å›½å®¶","è½åœ°åª’ä½“","è½åœ°å¹³å°","è½åœ°æ¬¡æ•°","é“¾æ¥","æˆªå›¾","å…¶ä»–","å…¶ä»–_1"],filteredData:[],allData:[],originalData:[],tableHeight:600,isFullscreen:!1,dateRange:[],isDateRangeInvalid:!1,tagExpression:"",expressionError:"",searchType:"",searchKeyword:"",statisticsDialogVisible:!1,statisticsData:[],isFromStatistics:!1,detailDialogVisible:!1,detailContent:"",detailColumn:"",detailRow:0,detailSequenceValue:"",sequenceGroups:null,currentGroupId:0,currentSequenceValue:null,hasSignatureArticleTag:!1,loading:!1,mediaStatisticsDialogVisible:!1,mediaStatisticsData:[]}},watch:{data:{immediate:!0,handler:function(t){console.log("å¼€å§‹æ•°æ®é¢„å¤„ç†");const e=this.fillSequenceNumbers(t),s=this.fillGroupColumns(e),i=this.filterEmptyColumns(s);this.originalData=i,this.allData=i,this.filteredData=i,this.$nextTick(()=>{this.calculateTableHeight()})}}},mounted(){setTimeout(()=>{this.calculateTableHeight()},100),window.addEventListener("resize",this.calculateTableHeight)},beforeDestroy(){window.removeEventListener("resize",this.calculateTableHeight)},methods:{fillGroupColumns(t){if(!t||0===t.length)return[];const e=JSON.parse(JSON.stringify(t)),s={};e.forEach(t=>{const e=t._sequenceGroup;e&&(s[e]||(s[e]=[]),s[e].push(t))});const i=["ç¨¿ä»¶æ ‡é¢˜","æ ‡ç­¾","å•æ¡æ€»ç»“/ä¸»é¢˜æ€»ç»“æ”¾æœ€æ–°ä¸€æ¡"];return Object.values(s).forEach(t=>{if(t.length>0){const e=t[0];t.forEach(t=>{i.forEach(s=>{void 0!==t[s]&&null!==t[s]&&""!==t[s]||(t[s]=e[s])})})}}),e},filterEmptyColumns(t){if(!t||0===t.length)return[];const e=JSON.parse(JSON.stringify(t)),s=[];return this.headers.forEach(t=>{let i=!1;for(let s=0;s<e.length;s++){const a=e[s][t];if(null!==a&&void 0!==a&&""!==a){i=!0;break}}i||s.push(t)}),this.headers=this.headers.filter(t=>!s.includes(t)),e.forEach(t=>{s.forEach(e=>{delete t[e]})}),e},handleDateChange(){if(this.dateRange&&2===this.dateRange.length){const t=new Date(this.dateRange[0]),e=new Date(this.dateRange[1]);this.isDateRangeInvalid=e<t,this.isDateRangeInvalid&&this.$message.warning({message:"ç»“æŸæ—¥æœŸä¸èƒ½æ—©äºå¼€å§‹æ—¥æœŸ",center:!0})}},parseDate(t){if(!t)return null;const e=/\d{4}å¹´/.test(t);let s,i,a;if(e){const e=t.match(/(\d{4})å¹´(\d{1,2})æœˆ(\d{1,2})æ—¥/);if(!e)return null;s=parseInt(e[1]),i=parseInt(e[2])-1,a=parseInt(e[3])}else{const e=t.match(/(\d{1,2})æœˆ(\d{1,2})æ—¥/);if(!e)return null;s=(new Date).getFullYear(),i=parseInt(e[1])-1,a=parseInt(e[2])}return new Date(s,i,a)},parseTags(t){return t?t.split(/[ï¼›;]/).map(t=>t.trim()).filter(t=>t):[]},tokenizeExpression(t){const e=[];let s="",i=0;const a=t.length,l={AND:"AND",OR:"OR",NOT:"NOT","å’Œ":"AND","æˆ–":"OR","é":"NOT","ä¸åŒ…æ‹¬":"NOT"},n=new Set(["AND","OR","NOT","å’Œ","æˆ–","é","ä¸åŒ…æ‹¬"]);while(i<a){const a=t[i];if(/\s/.test(a))s&&(n.has(s)?e.push({type:"OPERATOR",value:l[s]}):e.push({type:"TAG",value:s}),s=""),i++;else if("("!==a&&")"!==a&&"ï¼ˆ"!==a&&"ï¼‰"!==a)s+=a,i++;else{s&&(n.has(s)?e.push({type:"OPERATOR",value:l[s]}):e.push({type:"TAG",value:s}),s="");const t="ï¼ˆ"===a?"(":"ï¼‰"===a?")":a;e.push({type:"PAREN",value:t}),i++}}s&&(n.has(s)?e.push({type:"OPERATOR",value:l[s]}):e.push({type:"TAG",value:s}));for(let o=0;o<e.length;o++)"OPERATOR"===e[o].type&&"NOT"===e[o].value&&o>0&&("TAG"===e[o-1].type||")"===e[o-1].value)&&(e.splice(o,0,{type:"OPERATOR",value:"AND"}),o++);return e},parseExpression(t){let e=0;function s(){let s=i();while(e<t.length&&"OPERATOR"===t[e].type&&"OR"===t[e].value){const a=t[e++],l=i();s={type:"OPERATOR",value:a.value,left:s,right:l}}return s}function i(){let s=a();while(e<t.length&&"OPERATOR"===t[e].type&&"AND"===t[e].value){const i=t[e++],l=a();s={type:"OPERATOR",value:i.value,left:s,right:l}}return s}function a(){if(e>=t.length)throw new Error("è¡¨è¾¾å¼ä¸å®Œæ•´");const i=t[e];if("OPERATOR"===i.type&&"NOT"===i.value){e++;const t=a();return{type:"OPERATOR",value:"NOT",right:t}}if("PAREN"===i.type&&"("===i.value){e++;const i=s();if(e>=t.length||"PAREN"!==t[e].type||")"!==t[e].value)throw new Error("ç¼ºå°‘å³æ‹¬å·");return e++,i}if("TAG"===i.type)return e++,{type:"TAG",value:i.value};throw new Error("æ„å¤–çš„æ ‡è®°: "+i.value)}const l=s();if(e<t.length)throw new Error("æ„å¤–çš„æ ‡è®°: "+t[e].value);return l},astToLogicalString(t){if(!t)return"";switch(t.type){case"TAG":return t.value;case"OPERATOR":switch(t.value){case"AND":return`(${this.astToLogicalString(t.left)} && ${this.astToLogicalString(t.right)})`;case"OR":return`(${this.astToLogicalString(t.left)} || ${this.astToLogicalString(t.right)})`;case"NOT":return`!(${this.astToLogicalString(t.right)})`;default:return""}default:return""}},evaluateExpression(t,e){if(!t)return!0;switch(t.type){case"TAG":const s=t.value.toLowerCase();return Array.from(e).some(t=>t.toLowerCase()===s);case"OPERATOR":switch(t.value){case"AND":return this.evaluateExpression(t.left,e)&&this.evaluateExpression(t.right,e);case"OR":return this.evaluateExpression(t.left,e)||this.evaluateExpression(t.right,e);case"NOT":return!this.evaluateExpression(t.right,e);default:throw new Error("æœªçŸ¥çš„è¿ç®—ç¬¦: "+t.value)}default:throw new Error("æœªçŸ¥çš„èŠ‚ç‚¹ç±»å‹: "+t.type)}},filterByTags(t,e){const s=e.trim();if(!s)return t;try{this.expressionError="";const e=this.tokenizeExpression(s),i=this.parseExpression(e);this.hasSignatureArticleTag=s.toLowerCase().includes("ç½²åæ–‡ç« ");const a=this.astToLogicalString(i);console.log("æ ‡ç­¾æœç´¢é€»è¾‘:",a);const l=new Map;t.forEach(t=>{const e=t._sequenceGroup;e&&(l.has(e)||l.set(e,[]),l.get(e).push(t))});const n=[];return l.forEach(t=>{const e=t[0];if(!e["æ ‡ç­¾"])return;const s=new Set(this.parseTags(e["æ ‡ç­¾"]));this.evaluateExpression(i,s)&&n.push(...t)}),n}catch(i){console.error("æ ‡ç­¾è¡¨è¾¾å¼è§£æé”™è¯¯:",i),this.expressionError="è¡¨è¾¾å¼é”™è¯¯: "+i.message;try{const e=s;console.log("ä½¿ç”¨ç®€å•åŒ¹é…æ¨¡å¼æœç´¢:",e);const i=new Map;t.forEach(t=>{const e=t._sequenceGroup;e&&(i.has(e)||i.set(e,[]),i.get(e).push(t))});const a=[];return i.forEach(t=>{const s=t[0];if(!s["æ ‡ç­¾"])return;const i=this.parseTags(s["æ ‡ç­¾"]);i.some(t=>t.toLowerCase().includes(e.toLowerCase()))&&a.push(...t)}),a}catch(a){return this.expressionError="è¡¨è¾¾å¼é”™è¯¯: "+i.message,console.error("æ ‡ç­¾ç­›é€‰é”™è¯¯:",i),[]}}},checkSignatureArticleTag(t){if(!t)return!1;if("TAG"===t.type&&"ç½²åæ–‡ç« "===t.value)return!0;if("OPERATOR"===t.type){if(t.left&&this.checkSignatureArticleTag(t.left))return!0;if(t.right&&this.checkSignatureArticleTag(t.right))return!0}return!1},searchByDateRange(){let t=JSON.parse(JSON.stringify(this.originalData));if(this.dateRange&&2===this.dateRange.length){const e=new Date(this.dateRange[0]),s=new Date(this.dateRange[1]);if(e.setHours(0,0,0,0),s.setHours(23,59,59,999),s<e)return void this.$message.warning({message:"ç»“æŸæ—¥æœŸä¸èƒ½æ—©äºå¼€å§‹æ—¥æœŸ",center:!0});t=t.filter(t=>{if(!t["æ—¥æœŸ"])return!1;const i=this.parseDate(t["æ—¥æœŸ"]);return!!i&&(i>=e&&i<=s)})}if(this.searchType&&this.searchKeyword){const e=this.searchKeyword.toLowerCase();t=t.filter(t=>!!t[this.searchType]&&String(t[this.searchType]).toLowerCase().includes(e))}t=this.filterByTags(t,this.tagExpression),this.filteredData=JSON.parse(JSON.stringify(t)),this.$emit("filter-change",this.filteredData),this.addSequenceToGroupFirstRows(),this.sequenceGroups=null,this.currentGroupId=0,0===this.filteredData.length?this.$message.info({message:"æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ•°æ®",center:!0}):this.$message.success({message:"æ£€ç´¢æˆåŠŸ",center:!0})},addSequenceToGroupFirstRows(){if(!this.filteredData||0===this.filteredData.length)return;const t=this.headers[0]||"åºå·";let e=null;this.filteredData.forEach(s=>{const i=s._sequenceGroup;!i||i===e||s[t]&&""!==s[t]||(s[t]=i,s[t+"_isFiltered"]=!0),e=i})},resetTable(){this.dateRange,this.tagExpression,this.searchType,this.searchKeyword,this.filteredData.length;this.dateRange=[],this.isDateRangeInvalid=!1,this.tagExpression="",this.expressionError="",this.searchType="",this.searchKeyword="",this.hasSignatureArticleTag=!1,this.filteredData=JSON.parse(JSON.stringify(this.originalData)),this.$emit("filter-change",this.filteredData);const t=this.headers[0]||"åºå·";this.filteredData.forEach(e=>{e[t+"_isFiltered"]&&(e[t]="",delete e[t+"_isFiltered"]),e[t+"_isOriginal"]||(e[t]="")}),this.sequenceGroups=null,this.currentGroupId=0,this.$nextTick(()=>{this.$message.success({message:"å·²å¤åŸè¡¨æ ¼",center:!0,zIndex:99999})})},fillSequenceNumbers:function(t){if(!t||0===t.length)return t||[];const e=JSON.parse(JSON.stringify(t)),s="åºå·";let i=null,a=null;return e.forEach((t,e)=>{const l=t[s];null!=l&&""!==l?(i=l,a=l,t[s+"_isOriginal"]=!0):null!=i&&(t[s+"_isFilled"]=!0),t._sequenceGroup=a}),e},tableRowClassName:function({row:t}){const e=t._sequenceGroup;this.sequenceGroups||(this.sequenceGroups=new Map,this.currentGroupId=0),void 0===e||null===e||this.sequenceGroups.has(e)||(this.sequenceGroups.set(e,this.currentGroupId),this.currentGroupId++);const s=this.sequenceGroups.get(e);return s%2===0?"group-a-row":"group-b-row"},calculateTableHeight:function(){this.$nextTick(()=>{if(this.isFullscreen)this.tableHeight=window.innerHeight-100;else{const t=this.$parent.$el.querySelector(".data-container");if(t){const e=this.$el.querySelector(".table-controls"),s=e?e.offsetHeight:0,i=t.clientHeight;this.tableHeight=i-s-20}else this.tableHeight=window.innerHeight-300;this.tableHeight<200&&(this.tableHeight=200)}this.forceTableUpdate()})},isLongContent:function(t){if(null==t||""===t)return!1;const e=String(t);return e.length>30},handleCellHover:function(t,e,s){},handleStatisticCellHover:function(t,e){this.detailContent=null!=t?String(t):"",this.detailColumn=e,this.detailRow="ç»Ÿè®¡é¢æ¿",this.detailSequenceValue="",this.isFromStatistics=!0,this.detailDialogVisible=!0,this.$nextTick(()=>{this.fixDialogZIndex()})},handleStatisticsDialogOpen(){this.$nextTick(()=>{const t=document.querySelector(".statistics-dialog .el-dialog");t&&(t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.margin="0")})},copyCellContent:function(t){if(null==t)return;const e=String(t);this.copyToClipboard(e),this.$message.success({message:"å·²å¤åˆ¶åˆ°å‰ªè´´æ¿",center:!0})},showCellDetail:function(t,e,s){if(!this.isFullscreen){if(this.detailContent=null!=t?String(t):"",this.detailColumn=e,this.detailRow=s,this.isFromStatistics=!1,this.filteredData&&this.filteredData.length>0&&this.headers&&this.headers.length>0){const t=this.headers[0],e=this.filteredData[s-1];this.detailSequenceValue=e&&t&&(e._sequenceGroup||e[t])||""}else this.detailSequenceValue="";this.detailDialogVisible=!0,this.$nextTick(()=>{this.fixDialogZIndex()})}},copyDetailContent:function(){this.copyToClipboard(this.detailContent),this.$message.success({message:"å·²å¤åˆ¶åˆ°å‰ªè´´æ¿",center:!0})},copyToClipboard:function(t){const e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.select();try{document.execCommand("copy")}catch(s){console.error("å¤åˆ¶å¤±è´¥:",s),this.$message.error({message:"å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶",center:!0})}finally{document.body.removeChild(e)}},tableCellClassName:function({row:t,column:e,rowIndex:s,columnIndex:i}){return this.isLongContent(t[e.property])?"long-content-cell":""},forceTableUpdate:function(){this.$refs.dataTable&&this.$refs.dataTable.doLayout&&this.$refs.dataTable.doLayout()},scrollToTop:function(){const t=this.$refs.dataTable;if(t&&t.$el){const e=t.$el.querySelector(".el-table__body-wrapper");e&&(e.scrollTop=0)}},scrollToBottom:function(){const t=this.$refs.dataTable;if(t&&t.$el){const e=t.$el.querySelector(".el-table__body-wrapper");e&&(e.scrollTop=e.scrollHeight)}},toggleFullscreen:function(){this.isFullscreen=!this.isFullscreen,this.calculateTableHeight(),this.isFullscreen?document.body.style.overflow="hidden":document.body.style.overflow="",this.$nextTick((function(){this.forceTableUpdate()}))},getColumnWidth:function(t){if(!this.allData||0===this.allData.length)return 250;const e=this.allData.slice(0,100).map((function(e){const s=e[t];return null===s||void 0===s?"":String(s)})),s=Math.max(t.length,...e.map((function(t){return t.length}))),i=Math.max(250,Math.min(15*s,800));return i},showStatistics(){this.calculateStatistics(),this.statisticsDialogVisible=!0},calculateStatistics(){if(!this.filteredData||0===this.filteredData.length)return void(this.statisticsData=[{articleCount:0,countryCount:0,mediaCount:0,totalViews:0,mediaDetails:"æ— æ•°æ®",signatureInfo:this.hasSignatureArticleTag?"":void 0}]);const t=new Set,e=new Map;let s=0;const i=new Set,a=this.headers[0]||"åºå·";let l=[];if(this.hasSignatureArticleTag){const t=new Map;this.filteredData.forEach(e=>{const s=e._sequenceGroup;s&&(t.has(s)||t.set(s,[]),t.get(s).push(e))}),t.forEach(t=>{const e=t[0];if(!e["ç¨¿ä»¶æ ‡é¢˜"]||!e["ç¨¿ä»¶æ ‡é¢˜"].includes("ç½²åæ–‡ç« "))return;const s=e["ç¨¿ä»¶æ ‡é¢˜"],i=s.indexOf("ç½²åæ–‡ç« ");if(-1===i)return;const a=i+"ç½²åæ–‡ç« ".length,n=s.indexOf("ã€‹",a);if(-1!==n){const t=s.substring(0,n+1);l.push(t)}})}this.filteredData.forEach(l=>{if(l["å›½å®¶"]&&""!==l["å›½å®¶"]&&t.add(l["å›½å®¶"]),l["è½åœ°åª’ä½“"]&&""!==l["è½åœ°åª’ä½“"]){const t=l["è½åœ°åª’ä½“"].trim().toLowerCase();e.has(t)||e.set(t,l["è½åœ°åª’ä½“"].trim())}l["è½åœ°æ¬¡æ•°"]&&!isNaN(l["è½åœ°æ¬¡æ•°"])&&(s+=Number(l["è½åœ°æ¬¡æ•°"])),l[a]&&""!==l[a]&&i.add(l[a])});const n=Array.from(e.values()).join("ã€");this.statisticsData=[{articleCount:i.size,countryCount:t.size,mediaCount:e.size,totalViews:s,mediaDetails:n||"æ— æ•°æ®",signatureInfo:this.hasSignatureArticleTag?l.join("\n"):void 0}]},copyStatistics(){if(!this.statisticsData||0===this.statisticsData.length)return;const t=this.statisticsData[0],e=`å›½å®¶æ•°: ${t.countryCount}\nåª’ä½“æ•°: ${t.mediaCount}\næ€»è½åœ°æ¬¡æ•°: ${t.totalViews}\nåª’ä½“è¯¦æƒ…: ${t.mediaDetails}`;this.copyToClipboard(e),this.$message.success({message:"ç»Ÿè®¡ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿",center:!0})},formatCellValue:function(t,e,s){if(null==t)return"";const i=this.headers[0]||"åºå·";return s===i?e[i+"_isOriginal"]||e[i+"_isFiltered"]?t:"":"number"===typeof t?Number.isInteger(t)?t.toLocaleString():Number(t.toFixed(2)).toLocaleString():"boolean"===typeof t?t?"æ˜¯":"å¦":String(t)},fixDialogZIndex:function(){this.detailDialogVisible&&this.$nextTick(()=>{const t=document.querySelector(".cell-detail-dialog .el-dialog__wrapper"),e=document.querySelector(".cell-detail-dialog + .v-modal");if(t&&e){const s=this.isFullscreen?1e5:2e3;t.style.zIndex=s+2,e.style.zIndex=s+1;const i=t.querySelector(".el-dialog");i&&(i.style.zIndex=s+2)}})},showMediaStatistics(){this.calculateMediaStatistics(),this.mediaStatisticsDialogVisible=!0},calculateMediaStatistics(){if(!this.filteredData||0===this.filteredData.length)return void(this.mediaStatisticsData=[]);const t=new Map;this.headers[0];this.filteredData.forEach(e=>{if(!e["è½åœ°åª’ä½“"]||""===e["è½åœ°åª’ä½“"])return;const s=e["è½åœ°åª’ä½“"].trim().toLowerCase(),i=e["è½åœ°åª’ä½“"].trim(),a=e._sequenceGroup||"",l=e["è½åœ°æ¬¡æ•°"]?Number(e["è½åœ°æ¬¡æ•°"]):0;t.has(s)||t.set(s,{media:i,views:0,articles:0,sequences:new Set});const n=t.get(s);n.views+=l,a&&(n.sequences.add(a),n.articles=n.sequences.size)}),this.mediaStatisticsData=Array.from(t.values()).sort((t,e)=>e.views-t.views);const e=this.mediaStatisticsData.reduce((t,e)=>t+e.views,0),s=this.mediaStatisticsData.reduce((t,e)=>t+e.articles,0);this.mediaStatisticsData.push({media:"æ€»è®¡",views:e,articles:s,isTotal:!0})},copyMediaStatistics(){if(!this.mediaStatisticsData||0===this.mediaStatisticsData.length)return;let t="åª’ä½“\tæ¬¡æ•°\tç¯‡æ•°\n";this.mediaStatisticsData.forEach(e=>{t+=`${e.media}\t${e.views}\t${e.articles}\n`}),this.copyToClipboard(t),this.$message.success({message:"åˆ†åª’ä½“ç»Ÿè®¡ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿",center:!0})}}},r=o,c=(s("e98b"),s("2877")),u=Object(c["a"])(r,l,n,!1,null,"85bfab06",null),h=u.exports,d={name:"DataView",components:{DataTable:h},data(){return{csvData:[],csvHeaders:[],filteredDataLength:0}},computed:{hasData(){return this.csvData&&this.csvData.length>0}},created(){this.loadData()},methods:{loadData(){try{const t=localStorage.getItem("csvData"),e=localStorage.getItem("csvHeaders");t&&e?(this.csvData=JSON.parse(t),this.csvHeaders=JSON.parse(e),this.filteredDataLength=this.csvData.length):this.$message.warning("æ²¡æœ‰æ‰¾åˆ°æ•°æ®ï¼Œè¯·å…ˆä¸Šä¼ æ–‡ä»¶")}catch(t){console.error("åŠ è½½æ•°æ®å¤±è´¥:",t),this.$message.error("åŠ è½½æ•°æ®å¤±è´¥")}},handleFilterChange(t){this.filteredDataLength=t.length},goToUpload(){this.$router.push("/")}}},p=d,g=(s("6b57"),Object(c["a"])(p,i,a,!1,null,"ea6b1376",null));e["default"]=g.exports},b6c6:function(t,e,s){},e98b:function(t,e,s){"use strict";s("b6c6")}}]);
//# sourceMappingURL=chunk-30edbc11.eb9a8377.js.map